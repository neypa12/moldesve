<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Moldes.ve - Catálogo de Productos</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, sans-serif;
        }
        
        body {
            background-color: #f0f9f8;
            color: #333;
            line-height: 1.4;
            padding-bottom: 25px;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 0 12px;
        }
        
        /* Encabezado y perfil */
        header {
            text-align: center;
            padding: 22px 0 15px;
            background: linear-gradient(135deg, #0ea5a5 0%, #14b8b8 100%);
            color: white;
            border-radius: 0 0 12px 12px;
            margin-bottom: 22px;
            box-shadow: 0 2px 8px rgba(14, 165, 165, 0.25);
        }
        
        .profile-container {
            margin-bottom: 8px;
        }
        
        .profile-circle {
            width: 85px;
            height: 85px;
            border-radius: 50%;
            margin: 0 auto 8px;
            overflow: hidden;
            border: 4px solid rgba(255, 255, 255, 0.5);
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
            background-color: #f1f1f1;
        }
        
        .profile-circle img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        h1 {
            font-size: 24px;
            font-weight: 800;
            margin-bottom: 4px;
            letter-spacing: 0.3px;
            text-shadow: 0 2px 3px rgba(0, 0, 0, 0.2);
        }
        
        .tagline {
            font-size: 16px;
            opacity: 0.95;
            margin-bottom: 4px;
            font-weight: 500;
        }
        
        /* Buscador REDUCIDO */
        .search-container {
            max-width: 500px;
            margin: 20px auto 25px;
            padding: 0 15px;
        }
        
        .search-box {
            display: flex;
            background: white;
            border-radius: 30px;
            overflow: hidden;
            box-shadow: 0 3px 10px rgba(14, 165, 165, 0.2);
            border: 2px solid #e0f2f2;
            height: 50px;
        }
        
        .search-box input {
            flex: 1;
            border: none;
            padding: 0 20px;
            font-size: 15px;
            outline: none;
            color: #0d7377;
            font-weight: 500;
        }
        
        .search-box input::placeholder {
            color: #7dc5c5;
            font-weight: 500;
        }
        
        .search-box button {
            background: #0ea5a5;
            color: white;
            border: none;
            padding: 0 25px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 16px;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .search-box button:hover {
            background: #0d8a8a;
        }
        
        /* CATEGORÍAS COMO SELECT */
        .categories-container {
            max-width: 500px;
            margin: 0 auto 25px;
            padding: 0 15px;
        }
        
        .category-select {
            width: 100%;
            padding: 12px 20px;
            background: white;
            border: 2px solid #e0f2f2;
            border-radius: 10px;
            color: #0d7377;
            font-weight: 600;
            font-size: 15px;
            cursor: pointer;
            box-shadow: 0 3px 10px rgba(14, 165, 165, 0.15);
            outline: none;
            transition: all 0.3s;
        }
        
        .category-select:hover {
            border-color: #0ea5a5;
            box-shadow: 0 5px 15px rgba(14, 165, 165, 0.2);
        }
        
        .category-select:focus {
            border-color: #0ea5a5;
            box-shadow: 0 0 0 3px rgba(14, 165, 165, 0.2);
        }
        
        .category-select option {
            padding: 10px;
            font-weight: 500;
        }
        
        /* GRID RESPONSIVE - MÁXIMO 3 PRODUCTOS POR FILA */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(3, 250px);
            gap: 20px;
            margin-bottom: 20px;
            padding: 20px 0;
            justify-content: center;
        }
        
        .product-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(14, 165, 165, 0.15);
            transition: all 0.3s;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            width: 250px;
            max-width: 250px;
        }
        
        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(14, 165, 165, 0.25);
        }
        
        /* CONTENEDOR DE IMAGEN - IMAGEN COMPLETA Y CENTRADA */
        .product-img-container {
            position: relative;
            width: 100%;
            height: 200px;
            background-color: #f0f9f8;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .product-img {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            color: #0ea5a5;
            border-bottom: 2px solid #e0f2f2;
        }
        
        .product-img img {
            width: auto;
            height: auto;
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }
        
        .product-info {
            padding: 15px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            flex-grow: 1;
        }
        
        .product-name {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 10px;
            color: #0d7377;
            line-height: 1.3;
            text-align: center;
        }
        
        .product-price {
            font-size: 20px;
            font-weight: 800;
            color: #0ea5a5;
            text-align: center;
        }
        
        .product-price .old-price {
            text-decoration: line-through;
            color: #999;
            font-size: 16px;
            font-weight: normal;
            display: block;
            margin-bottom: 2px;
        }
        
        .product-price .discount-badge {
            background: #ff6b6b;
            color: white;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 12px;
            font-weight: bold;
            margin-left: 5px;
        }
        
        .product-price span {
            font-size: 14px;
            font-weight: 600;
            color: #7dc5c5;
        }
        
        /* Pie de página */
        footer {
            text-align: center;
            margin-top: 35px;
            padding-top: 15px;
            border-top: 2px solid #e0f2f2;
            color: #0d7377;
            font-size: 14px;
            font-weight: 600;
        }
        
        /* RESPONSIVE BREAKPOINTS */
        @media (max-width: 850px) {
            .products-grid {
                grid-template-columns: repeat(2, 250px);
                gap: 15px;
            }
        }
        
        @media (max-width: 600px) {
            .products-grid {
                grid-template-columns: repeat(1, 250px);
                gap: 15px;
            }
            
            .product-img-container {
                height: 180px;
            }
            
            .product-img {
                font-size: 35px;
            }
            
            .product-info {
                padding: 12px;
            }
            
            .product-name {
                font-size: 15px;
            }
            
            .product-price {
                font-size: 18px;
            }
            
            h1 {
                font-size: 22px;
            }
            
            .profile-circle {
                width: 75px;
                height: 75px;
            }
            
            .tagline {
                font-size: 14px;
            }
            
            .search-box input {
                padding: 0 15px;
                font-size: 14px;
            }
            
            .search-box button {
                padding: 0 15px;
                font-size: 14px;
            }
            
            .search-box {
                height: 45px;
            }
            
            .container {
                padding: 0 10px;
            }
        }
        
        /* POPUP ESTILOS */
        .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .popup-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        /* Contenedor principal del popup */
        .popup-content {
            background-color: white;
            border-radius: 15px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: row;
            transform: scale(0.9);
            transition: transform 0.3s ease;
        }
        
        .popup-overlay.active .popup-content {
            transform: scale(1);
        }
        
        /* Izquierda - Imágenes */
        .popup-left {
            flex: 1;
            background-color: #f0f9f8;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
            min-width: 300px;
        }
        
        /* Contenedor de imagen principal */
        .popup-image-container {
            width: 100%;
            height: 350px;
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .popup-main-image {
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 70px;
            color: #0ea5a5;
            background-color: white;
        }
        
        .popup-main-image img {
            width: auto;
            height: auto;
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }
        
        /* BOTONES DE NAVEGACIÓN DE IMÁGENES */
        .prev-image-btn, .next-image-btn {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background-color: rgba(14, 165, 165, 0.8);
            color: white;
            border: none;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 16px;
            transition: all 0.2s;
            z-index: 10;
            opacity: 0.7;
        }
        
        .prev-image-btn {
            left: 15px;
        }
        
        .next-image-btn {
            right: 15px;
        }
        
        .prev-image-btn:hover, .next-image-btn:hover {
            background-color: #0d8a8a;
            opacity: 1;
            transform: translateY(-50%) scale(1.1);
        }
        
        /* Derecha - Información */
        .popup-right {
            flex: 1;
            padding: 30px;
            display: flex;
            flex-direction: column;
            min-width: 300px;
            overflow-y: auto;
            max-height: 70vh;
        }
        
        .popup-product-name {
            font-size: 22px;
            color: #0d7377;
            margin-bottom: 15px;
            font-weight: 700;
        }
        
        .popup-price {
            font-size: 18px;
            color: #0ea5a5;
            font-weight: 700;
            margin-bottom: 20px;
        }
        
        .popup-price .old-price {
            text-decoration: line-through;
            color: #999;
            font-size: 16px;
            font-weight: normal;
            margin-right: 10px;
        }
        
        .popup-price .discount-badge {
            background: #ff6b6b;
            color: white;
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: bold;
            margin-left: 10px;
        }
        
        .popup-currency {
            font-size: 16px;
            color: #0d7377;
            font-weight: 500;
        }
        
        /* TAMAÑOS EDITABLES */
        .size-options {
            margin-bottom: 20px;
        }
        
        .size-title {
            font-size: 16px;
            color: #0d7377;
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .size-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .size-btn {
            padding: 8px 16px;
            background-color: #f0f9f8;
            border: 2px solid #c2e7e7;
            border-radius: 8px;
            color: #0d7377;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 600;
            font-size: 14px;
        }
        
        .size-btn:hover {
            background-color: #e0f2f2;
        }
        
        .size-btn.active {
            background-color: #0ea5a5;
            color: white;
            border-color: #0ea5a5;
        }
        
        .characteristics {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #e0f2f2;
        }
        
        .characteristics-title {
            font-size: 16px;
            color: #0d7377;
            margin-bottom: 10px;
            font-weight: 600;
        }
        
        .characteristics-text {
            font-size: 14px;
            color: #666;
            line-height: 1.5;
        }
        
        /* Estilo para la barra de desplazamiento */
        .popup-right::-webkit-scrollbar {
            width: 6px;
        }
        
        .popup-right::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 3px;
        }
        
        .popup-right::-webkit-scrollbar-thumb {
            background: #0ea5a5;
            border-radius: 3px;
        }
        
        .popup-right::-webkit-scrollbar-thumb:hover {
            background: #0d8a8a;
        }
        
        .close-popup {
            position: absolute;
            top: 15px;
            right: 15px;
            background-color: rgba(255, 255, 255, 0.9);
            border: none;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 18px;
            color: #0d7377;
            z-index: 100;
            transition: all 0.2s;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        
        .close-popup:hover {
            background-color: white;
            transform: scale(1.1);
            color: #0ea5a5;
        }
        
        /* RESPONSIVE PARA EL POPUP */
        @media (max-width: 768px) {
            .popup-content {
                flex-direction: column;
                width: 95%;
                max-width: 500px;
                max-height: 85vh;
                overflow-y: auto;
            }
            
            .popup-left, .popup-right {
                min-width: auto;
            }
            
            .popup-left {
                min-height: 250px;
                flex-shrink: 0;
            }
            
            .popup-image-container {
                height: 250px;
            }
            
            .popup-right {
                padding: 20px;
                max-height: none;
                overflow-y: visible;
            }
            
            .popup-product-name {
                font-size: 20px;
            }
            
            .popup-price {
                font-size: 18px;
            }
            
            .popup-main-image {
                font-size: 60px;
            }
        }
        
        @media (max-width: 480px) {
            .popup-content {
                max-width: 350px;
            }
            
            .popup-left {
                min-height: 200px;
            }
            
            .popup-image-container {
                height: 200px;
            }
            
            .popup-main-image {
                font-size: 50px;
            }
            
            .popup-product-name {
                font-size: 18px;
            }
            
            .popup-price {
                font-size: 18px;
            }
            
            .size-btn {
                padding: 6px 12px;
                font-size: 13px;
            }
            
            .size-title {
                font-size: 15px;
            }
            
            .characteristics-text {
                font-size: 13px;
            }
        }

        /* ESTILOS PARA EL FORMULARIO DE WHATSAPP */
        .whatsapp-section {
            margin-top: 25px;
            padding-top: 20px;
            border-top: 1px solid #e0f2f2;
        }

        .whatsapp-btn {
            width: 100%;
            padding: 14px;
            background-color: #25D366;
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            box-shadow: 0 4px 10px rgba(37, 211, 102, 0.3);
        }

        .whatsapp-btn:hover {
            background-color: #1da851;
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(37, 211, 102, 0.4);
        }

        .whatsapp-btn:active {
            transform: translateY(-1px);
        }

        .fabrication-notice {
            background-color: #fff9e6;
            border: 1px solid #ffd54f;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            display: none;
            align-items: flex-start;
            gap: 12px;
            animation: fadeIn 0.5s ease;
            box-shadow: 0 3px 8px rgba(255, 213, 79, 0.1);
        }
        
        .fabrication-notice.active {
            display: flex;
        }
        
        .fabrication-notice i {
            color: #ff9800;
            font-size: 20px;
            flex-shrink: 0;
            margin-top: 2px;
        }
        
        .fabrication-notice p {
            color: #5d4037;
            font-size: 14px;
            line-height: 1.5;
            margin: 0;
            font-weight: 500;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .whatsapp-form {
            margin-top: 15px;
            padding: 20px;
            background-color: #f8fdf8;
            border-radius: 10px;
            border: 2px solid #e0f2f2;
            display: none;
            animation: slideDown 0.3s ease;
        }
        
        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .whatsapp-form.active {
            display: block;
        }

        .form-title {
            font-size: 18px;
            color: #0d7377;
            margin-bottom: 8px;
            font-weight: 700;
        }

        .form-info {
            font-size: 14px;
            color: #666;
            margin-bottom: 20px;
        }

        .form-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }

        .form-group {
            flex: 1;
        }

        .form-group label {
            display: block;
            font-size: 14px;
            color: #0d7377;
            margin-bottom: 6px;
            font-weight: 600;
        }

        .form-group input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #c2e7e7;
            border-radius: 8px;
            font-size: 15px;
            color: #0d7377;
            background-color: white;
            transition: all 0.3s;
        }

        .form-group input:focus {
            outline: none;
            border-color: #0ea5a5;
            box-shadow: 0 0 0 3px rgba(14, 165, 165, 0.2);
        }

        .form-group input::placeholder {
            color: #7dc5c5;
        }

        .form-notice {
            background-color: #e8f4fc;
            padding: 12px;
            border-radius: 8px;
            margin: 20px 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-notice p {
            font-size: 14px;
            color: #0d7377;
            margin: 0;
        }

        .form-notice i {
            color: #0ea5a5;
            font-size: 16px;
        }

        .submit-request-btn {
            width: 100%;
            padding: 16px;
            background-color: #25D366;
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            box-shadow: 0 4px 10px rgba(37, 211, 102, 0.3);
        }

        .submit-request-btn:hover {
            background-color: #1da851;
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(37, 211, 102, 0.4);
        }

        .submit-request-btn:active {
            transform: translateY(-1px);
        }

        /* LOADER PARA CARGA DE DATOS */
        .loader {
            display: none;
            text-align: center;
            padding: 30px;
            color: #0d7377;
        }
        
        .loader.active {
            display: block;
        }
        
        .loader i {
            font-size: 40px;
            margin-bottom: 15px;
            color: #0ea5a5;
        }

        /* Estilos responsivos para el formulario */
        @media (max-width: 768px) {
            .form-row {
                flex-direction: column;
                gap: 12px;
            }
            
            .whatsapp-btn, .submit-request-btn {
                padding: 12px;
                font-size: 15px;
            }
            
            .fabrication-notice {
                padding: 12px;
            }
        }

        @media (max-width: 480px) {
            .whatsapp-form {
                padding: 15px;
            }
            
            .form-title {
                font-size: 16px;
            }
            
            .form-group input {
                padding: 10px 12px;
                font-size: 14px;
            }
            
            .whatsapp-btn, .submit-request-btn {
                font-size: 14px;
                padding: 12px;
            }
            
            .fabrication-notice p {
                font-size: 13px;
            }
            
            .fabrication-notice i {
                font-size: 18px;
            }
        }
    </style>
</head>
<body>
    <div class="loader" id="loader">
        <i class="fas fa-spinner fa-spin"></i>
        <p>Cargando catálogo de productos...</p>
    </div>
    
    <div id="content" style="display: none;">
        <header>
            <div class="container">
                <div class="profile-container">
                    <div class="profile-circle">
                        <img src="" alt="Logo de la tienda" id="profileImage">
                    </div>
                    <h1 id="storeName">Cargando...</h1>
                    <p class="tagline" id="storeTagline">Cargando...</p>
                </div>
            </div>
        </header>
        
        <main class="container">
            <!-- Buscador -->
            <div class="search-container">
                <div class="search-box">
                    <input type="text" placeholder="Buscar productos..." id="searchInput">
                    <button id="searchButton"><i class="fas fa-search"></i></button>
                </div>
            </div>
            
            <!-- CATEGORÍAS COMO SELECT -->
            <div class="categories-container">
                <select class="category-select" id="categorySelect">
                    <option value="all">Cargando categorías...</option>
                </select>
            </div>
            
            <!-- Todos los productos en grid -->
            <div class="products-grid" id="productsGrid">
                <!-- Los productos se cargan aquí automáticamente -->
                <div class="loader">
                    <i class="fas fa-spinner fa-spin"></i>
                    <p>Cargando productos...</p>
                </div>
            </div>
        </main>
        
        <footer class="container">
            <p id="footerText">© 2023 Tienda - Todos los derechos reservados</p>
        </footer>
        
        <!-- POPUP DE PRODUCTO -->
        <div class="popup-overlay" id="productPopup">
            <div class="popup-content">
                <button class="close-popup" id="closePopup">
                    <i class="fas fa-times"></i>
                </button>
                
                <div class="popup-left">
                    <div class="popup-image-container">
                        <div class="popup-main-image" id="popupMainImage">
                            <i class="fas fa-box"></i>
                        </div>
                    </div>
                    
                    <!-- BOTONES DE NAVEGACIÓN DE IMÁGENES -->
                    <button class="prev-image-btn" id="prevImageBtn">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <button class="next-image-btn" id="nextImageBtn">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
                
                <div class="popup-right">
                    <div>
                        <h2 class="popup-product-name" id="popupProductName">Cargando producto...</h2>
                        
                        <div class="popup-price" id="popupPrice">
                            Precio: $<span id="popupPriceValue">0.00</span> <span class="popup-currency" id="popupCurrency">USD</span>
                        </div>
                        
                        <!-- TAMAÑOS EDITABLES -->
                        <div class="size-options" id="sizeOptionsContainer">
                            <h3 class="size-title">Elegir tamaño:</h3>
                            <div class="size-buttons" id="sizeButtons">
                                <!-- Los botones de tamaño se cargan aquí -->
                            </div>
                        </div>
                        
                        <div class="characteristics">
                            <h3 class="characteristics-title">Características:</h3>
                            <p class="characteristics-text" id="popupCharacteristics">
                                Cargando características...
                            </p>
                        </div>

                        <!-- FORMULARIO DE WHATSAPP -->
                        <div class="whatsapp-section">
                            <button class="whatsapp-btn" id="whatsappBtn">
                                <i class="fab fa-whatsapp"></i> Pedir fabricación por WhatsApp
                            </button>
                            
                            <!-- AVISO VISUAL DE FABRICACIÓN -->
                            <div class="fabrication-notice" id="fabricationNotice">
                                <i class="fas fa-info-circle"></i>
                                <p>Iniciamos fabricación con el 50% de adelanto. El resto se paga al retirar el producto.</p>
                            </div>
                            
                            <div class="whatsapp-form" id="whatsappForm">
                                <h3 class="form-title">Solicitar fabricación</h3>
                                <p class="form-info">Complete sus datos para enviar la solicitud por WhatsApp</p>
                                
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="clientName">Nombre *</label>
                                        <input type="text" id="clientName" placeholder="Ej: María" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="clientLastName">Apellido *</label>
                                        <input type="text" id="clientLastName" placeholder="Ej: González" required>
                                    </div>
                                </div>
                                
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="clientPhone">Teléfono *</label>
                                        <input type="tel" id="clientPhone" placeholder="Ej: 584141234567" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="clientCity">Ciudad *</label>
                                        <input type="text" id="clientCity" placeholder="Ej: Caracas" required>
                                    </div>
                                </div>
                                
                                <div class="form-notice">
                                    <p><i class="fas fa-info-circle"></i> Todos los campos son obligatorios.</p>
                                </div>
                                
                                <button class="submit-request-btn" id="submitRequestBtn">
                                    <i class="fab fa-whatsapp"></i> Enviar solicitud por WhatsApp
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

<script>
// =============================================
// VARIABLES GLOBALES
// =============================================

let tiendaData = {
    config: {},
    categorias: [],
    productos: []
};

let currentProductId = null;
let currentImageIndex = 0;
let selectedSize = "";
let productoImagenes = [];

// =============================================
// FUNCIONES PRINCIPALES
// =============================================

// Función para limpiar URLs de imágenes
function limpiarURLImagen(url) {
    if (!url) return '';
    return url.trim().replace(/\n/g, '').replace(/\r/g, '');
}

// Cargar datos desde el archivo JSON
async function cargarDatos() {
    try {
        console.log('Cargando datos desde datos.json...');
        
        // Cargar el archivo JSON
        const respuesta = await fetch('datos.json');
        if (!respuesta.ok) {
            throw new Error(`Error HTTP: ${respuesta.status}`);
        }
        
        tiendaData = await respuesta.json();
        
        console.log('Datos cargados correctamente:', {
            productos: tiendaData.productos.length,
            categorias: tiendaData.categorias.length,
            config: tiendaData.config
        });
        
        return true;
    } catch (error) {
        console.error('Error cargando datos:', error);
        
        // Mostrar mensaje de error al usuario
        document.getElementById('loader').innerHTML = `
            <i class="fas fa-exclamation-triangle" style="color: #e74c3c;"></i>
            <p>Error cargando los datos de la tienda</p>
            <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-top: 15px; text-align: left; max-width: 500px; margin-left: auto; margin-right: auto;">
                <p style="font-size: 14px; margin-bottom: 10px;"><strong>Posibles causas:</strong></p>
                <ol style="font-size: 13px; text-align: left; margin-left: 20px;">
                    <li>El archivo "datos.json" no existe</li>
                    <li>Hay un error en la sintaxis del JSON</li>
                    <li>Problema temporal de conexión</li>
                </ol>
                <p style="font-size: 12px; margin-top: 10px;">
                    Verifica que el archivo "datos.json" esté en la misma carpeta que index.html
                </p>
            </div>
        `;
        
        return false;
    }
}

// Mostrar productos en la página
function mostrarProductos() {
    const grid = document.getElementById('productsGrid');
    grid.innerHTML = '';
    
    if (tiendaData.productos.length === 0) {
        grid.innerHTML = `
            <div style="grid-column: 1 / -1; text-align: center; padding: 40px; color: #666;">
                <i class="fas fa-box-open" style="font-size: 50px; margin-bottom: 20px; color: #ccc;"></i>
                <h3>No hay productos disponibles</h3>
                <p>Agrega productos al archivo datos.json</p>
            </div>
        `;
        return;
    }
    
    tiendaData.productos.forEach(producto => {
        // Calcular precio con descuento
        const precioBase = parseFloat(producto.precio || 0);
        const descuento = parseInt(producto.descuento || 0);
        const precioFinal = descuento > 0 ? 
            precioBase * (1 - descuento / 100) : 
            precioBase;
        
        // Obtener y limpiar URL de imagen
        const imagenURL = limpiarURLImagen(producto.imagen || '');
        const tieneImagen = imagenURL && (imagenURL.startsWith('http') || imagenURL.startsWith('https'));
        
        const card = document.createElement('div');
        card.className = 'product-card';
        card.setAttribute('data-product', producto.id);
        card.setAttribute('data-category', producto.categoria || '');
        
        card.innerHTML = `
            <div class="product-img-container">
                <div class="product-img">
                    ${tieneImagen ? 
                        `<img src="${imagenURL}" alt="${producto.nombre || 'Producto'}" 
                              onerror="this.style.display='none'; this.parentElement.innerHTML='<i class=\"fas fa-box\"></i>';">` : 
                        `<i class="fas fa-box"></i>`
                    }
                </div>
            </div>
            <div class="product-info">
                <h3 class="product-name">${producto.nombre || 'Producto sin nombre'}</h3>
                <div class="product-price">
                    ${descuento > 0 ? 
                        `<span class="old-price">$${precioBase.toFixed(2)}</span>` : 
                        ''
                    }
                    $${precioFinal.toFixed(2)}
                    ${descuento > 0 ? 
                        `<span class="discount-badge">-${descuento}%</span>` : 
                        ''
                    }
                    <span>${tiendaData.config.Moneda || 'USD'}</span>
                </div>
            </div>
        `;
        
        card.addEventListener('click', () => abrirPopupProducto(parseInt(producto.id)));
        grid.appendChild(card);
    });
}

// Mostrar categorías en el select
function mostrarCategorias() {
    const select = document.getElementById('categorySelect');
    select.innerHTML = '';
    
    // Agregar categoría "Todos" primero
    const optionTodos = document.createElement('option');
    optionTodos.value = 'all';
    optionTodos.textContent = 'Todos';
    select.appendChild(optionTodos);
    
    // Agregar el resto de categorías
    tiendaData.categorias.forEach(categoria => {
        const option = document.createElement('option');
        option.value = categoria.id;
        option.textContent = categoria.nombre;
        select.appendChild(option);
    });
}

// Filtrar productos por categoría
function filtrarPorCategoria(categoriaId) {
    const cards = document.querySelectorAll('.product-card');
    
    cards.forEach(card => {
        if (categoriaId === 'all') {
            card.style.display = 'flex';
        } else {
            const categoriaProducto = card.getAttribute('data-category');
            card.style.display = categoriaProducto === categoriaId ? 'flex' : 'none';
        }
    });
}

// Configurar buscador
function configurarBuscador() {
    const searchInput = document.getElementById('searchInput');
    const searchButton = document.getElementById('searchButton');
    
    function realizarBusqueda() {
        const termino = searchInput.value.toLowerCase().trim();
        const cards = document.querySelectorAll('.product-card');
        
        cards.forEach(card => {
            const productId = parseInt(card.getAttribute('data-product'));
            const producto = tiendaData.productos.find(p => parseInt(p.id) === productId);
            const nombre = (producto.nombre || '').toLowerCase();
            
            card.style.display = nombre.includes(termino) || termino === '' ? 'flex' : 'none';
        });
    }
    
    searchButton.addEventListener('click', realizarBusqueda);
    searchInput.addEventListener('keyup', (e) => e.key === 'Enter' && realizarBusqueda());
}

// Configurar información de la tienda
function configurarTienda() {
    const config = tiendaData.config;
    
    // Nombre de la tienda
    if (config["Nombre Tienda"]) {
        document.getElementById('storeName').textContent = config["Nombre Tienda"];
    }
    
    // Tagline
    if (config.Tagline) {
        document.getElementById('storeTagline').textContent = config.Tagline;
    }
    
    // Logo/Imagen de perfil
    if (config.Logo) {
        const profileImage = document.getElementById('profileImage');
        profileImage.src = config.Logo;
        profileImage.alt = `Logo de ${config["Nombre Tienda"] || 'la tienda'}`;
    }
    
    // WhatsApp
    if (config.WhatsApp) {
        window.whatsappNumber = config.WhatsApp;
    }
    
    // Año del copyright
    const year = new Date().getFullYear();
    const nombreTienda = config["Nombre Tienda"] || 'Tienda';
    document.getElementById('footerText').textContent = 
        `© ${year} ${nombreTienda} - Todos los derechos reservados`;
}

// Funcionalidad del popup
function abrirPopupProducto(productId) {
    const producto = tiendaData.productos.find(p => parseInt(p.id) === productId);
    if (!producto) return;
    
    currentProductId = productId;
    currentImageIndex = 0;
    
    // Obtener imágenes del producto
    productoImagenes = [];
    const imagenPrincipal = limpiarURLImagen(producto.imagen || '');
    
    if (imagenPrincipal && (imagenPrincipal.startsWith('http') || imagenPrincipal.startsWith('https'))) {
        productoImagenes.push(imagenPrincipal);
    }
    
    // Si hay imágenes adicionales en el producto, agregarlas
    if (producto.imagenesAdicionales && Array.isArray(producto.imagenesAdicionales)) {
        producto.imagenesAdicionales.forEach(img => {
            const imgLimpia = limpiarURLImagen(img);
            if (imgLimpia && imgLimpia.startsWith('http')) {
                productoImagenes.push(imgLimpia);
            }
        });
    }
    
    // Actualizar información del popup
    document.getElementById('popupProductName').textContent = producto.nombre || 'Producto';
    document.getElementById('popupCharacteristics').textContent = producto.descripcion || producto.caracteristicas || 'Sin descripción disponible';
    
    // Mostrar primera imagen
    mostrarImagenPopup(0);
    
    // Actualizar precios y tamaños
    actualizarPreciosYTamanos(producto);
    
    // Configurar botones de navegación de imágenes
    configurarBotonesImagenes();
    
    // Ocultar formulario de WhatsApp si estaba abierto
    document.getElementById('whatsappForm').classList.remove('active');
    document.getElementById('fabricationNotice').classList.remove('active');
    document.getElementById('whatsappBtn').innerHTML = '<i class="fab fa-whatsapp"></i> Pedir fabricación por WhatsApp';
    
    // Mostrar popup
    document.getElementById('productPopup').classList.add('active');
    document.body.style.overflow = 'hidden';
}

// Mostrar imagen específica en el popup
function mostrarImagenPopup(index) {
    const popupImage = document.getElementById('popupMainImage');
    
    if (productoImagenes.length > 0 && index < productoImagenes.length) {
        popupImage.innerHTML = `<img src="${productoImagenes[index]}" alt="Imagen ${index + 1} del producto">`;
        currentImageIndex = index;
    } else {
        popupImage.innerHTML = '<i class="fas fa-box"></i>';
    }
    
    // Mostrar u ocultar botones de navegación
    const prevBtn = document.getElementById('prevImageBtn');
    const nextBtn = document.getElementById('nextImageBtn');
    
    if (productoImagenes.length <= 1) {
        prevBtn.style.display = 'none';
        nextBtn.style.display = 'none';
    } else {
        prevBtn.style.display = 'flex';
        nextBtn.style.display = 'flex';
    }
}

// Configurar botones de navegación de imágenes
function configurarBotonesImagenes() {
    const prevBtn = document.getElementById('prevImageBtn');
    const nextBtn = document.getElementById('nextImageBtn');
    
    // Limpiar event listeners anteriores
    const prevClone = prevBtn.cloneNode(true);
    const nextClone = nextBtn.cloneNode(true);
    prevBtn.parentNode.replaceChild(prevClone, prevBtn);
    nextBtn.parentNode.replaceChild(nextClone, nextBtn);
    
    // Nueva referencia a los botones
    const newPrevBtn = document.getElementById('prevImageBtn');
    const newNextBtn = document.getElementById('nextImageBtn');
    
    newPrevBtn.addEventListener('click', () => {
        let newIndex = currentImageIndex - 1;
        if (newIndex < 0) newIndex = productoImagenes.length - 1;
        mostrarImagenPopup(newIndex);
    });
    
    newNextBtn.addEventListener('click', () => {
        let newIndex = currentImageIndex + 1;
        if (newIndex >= productoImagenes.length) newIndex = 0;
        mostrarImagenPopup(newIndex);
    });
}

// Actualizar precios y tamaños en el popup (TAMAÑOS EDITABLES)
function actualizarPreciosYTamanos(producto) {
    const precioBase = parseFloat(producto.precio || 0);
    const descuento = parseInt(producto.descuento || 0);
    const precioFinal = descuento > 0 ? 
        precioBase * (1 - descuento / 100) : 
        precioBase;
    
    // Mostrar precio
    const precioElement = document.getElementById('popupPrice');
    const moneda = tiendaData.config.Moneda || 'USD';
    
    let precioHTML = '';
    if (descuento > 0) {
        precioHTML = `
            <span class="old-price">$${precioBase.toFixed(2)}</span>
            $<span id="popupPriceValue">${precioFinal.toFixed(2)}</span>
            <span class="popup-currency">${moneda}</span>
            <span class="discount-badge">-${descuento}%</span>
        `;
    } else {
        precioHTML = `
            $<span id="popupPriceValue">${precioFinal.toFixed(2)}</span>
            <span class="popup-currency">${moneda}</span>
        `;
    }
    
    precioElement.innerHTML = `Precio: ${precioHTML}`;
    
    // Crear botones de tamaños EDITABLES
    const tamanos = producto.tamanos || {};
    const sizeButtons = document.getElementById('sizeButtons');
    const sizeOptionsContainer = document.getElementById('sizeOptionsContainer');
    sizeButtons.innerHTML = '';
    
    const tamanoKeys = Object.keys(tamanos);
    
    if (tamanoKeys.length > 0) {
        // Ordenar tamaños por valor numérico (4cm, 6cm, 8cm, etc.)
        tamanoKeys.sort((a, b) => {
            const numA = parseFloat(a.replace('cm', ''));
            const numB = parseFloat(b.replace('cm', ''));
            return numA - numB;
        });
        
        tamanoKeys.forEach((tamano, index) => {
            const precioTamano = parseFloat(tamanos[tamano]);
            const precioConDescuento = descuento > 0 ? 
                precioTamano * (1 - descuento / 100) : 
                precioTamano;
            
            const button = document.createElement('button');
            button.className = `size-btn ${index === 0 ? 'active' : ''}`;
            button.setAttribute('data-size', tamano);
            button.setAttribute('data-price', precioConDescuento);
            button.textContent = tamano;
            
            button.addEventListener('click', function() {
                document.querySelectorAll('.size-btn').forEach(btn => btn.classList.remove('active'));
                this.classList.add('active');
                selectedSize = this.getAttribute('data-size');
                document.getElementById('popupPriceValue').textContent = parseFloat(this.getAttribute('data-price')).toFixed(2);
            });
            
            sizeButtons.appendChild(button);
        });
        
        // Establecer primer tamaño como seleccionado
        selectedSize = tamanoKeys[0];
        sizeOptionsContainer.style.display = 'block';
        
        // Actualizar precio al primer tamaño
        const primerPrecio = descuento > 0 ? 
            parseFloat(tamanos[tamanoKeys[0]]) * (1 - descuento / 100) : 
            parseFloat(tamanos[tamanoKeys[0]]);
        document.getElementById('popupPriceValue').textContent = primerPrecio.toFixed(2);
    } else {
        // Sin tamaños específicos, ocultar la sección
        sizeOptionsContainer.style.display = 'none';
    }
}

// Funcionalidad de WhatsApp
function configurarWhatsApp() {
    const whatsappBtn = document.getElementById('whatsappBtn');
    const whatsappForm = document.getElementById('whatsappForm');
    const submitBtn = document.getElementById('submitRequestBtn');
    const fabricationNotice = document.getElementById('fabricationNotice');
    
    whatsappBtn.addEventListener('click', function() {
        const isOpening = !whatsappForm.classList.contains('active');
        whatsappForm.classList.toggle('active');
        fabricationNotice.classList.toggle('active');
        
        if (isOpening) {
            whatsappBtn.innerHTML = '<i class="fab fa-whatsapp"></i> Ocultar formulario';
        } else {
            whatsappBtn.innerHTML = '<i class="fab fa-whatsapp"></i> Pedir fabricación por WhatsApp';
        }
    });
    
    submitBtn.addEventListener('click', function() {
        // Validar campos
        const nombre = document.getElementById('clientName').value.trim();
        const apellido = document.getElementById('clientLastName').value.trim();
        const telefono = document.getElementById('clientPhone').value.trim();
        const ciudad = document.getElementById('clientCity').value.trim();
        
        if (!nombre || !apellido || !telefono || !ciudad) {
            alert('Por favor, complete todos los campos obligatorios.');
            return;
        }
        
        // Validar teléfono (solo números, mínimo 10 dígitos)
        const telefonoLimpio = telefono.replace(/\D/g, '');
        if (telefonoLimpio.length < 10) {
            alert('Por favor, ingrese un número de teléfono válido (mínimo 10 dígitos).');
            return;
        }
        
        // Obtener datos del producto actual
        const producto = tiendaData.productos.find(p => parseInt(p.id) === currentProductId);
        if (!producto) return;
        
        // Obtener precio y tamaño seleccionado
        const sizeBtnActive = document.querySelector('.size-btn.active');
        let precio = parseFloat(document.getElementById('popupPriceValue').textContent);
        let tamano = 'Único';
        
        if (sizeBtnActive) {
            precio = parseFloat(sizeBtnActive.getAttribute('data-price'));
            tamano = sizeBtnActive.getAttribute('data-size');
        }
        
        const moneda = tiendaData.config.Moneda || 'USD';
        
        // Crear mensaje para WhatsApp
        const mensaje = `¡Hola! Quiero solicitar fabricación de:%0A%0A` +
                       `*Producto:* ${producto.nombre || 'Producto'}%0A` +
                       `*Tamaño:* ${tamano}%0A` +
                       `*Precio:* $${precio.toFixed(2)} ${moneda}%0A%0A` +
                       `*Mis datos:*%0A` +
                       `- Nombre: ${nombre} ${apellido}%0A` +
                       `- Teléfono: ${telefonoLimpio}%0A` +
                       `- Ciudad: ${ciudad}%0A%0A` +
                       `Me gustaría más información sobre este producto.`;
        
        // Número de WhatsApp (de configuración o por defecto)
        const numeroWhatsApp = window.whatsappNumber || tiendaData.config.WhatsApp || '584141234567';
        const whatsappURL = `https://wa.me/${numeroWhatsApp}?text=${mensaje}`;
        
        // Abrir WhatsApp
        window.open(whatsappURL, '_blank');
        
        // Limpiar formulario
        document.getElementById('clientName').value = '';
        document.getElementById('clientLastName').value = '';
        document.getElementById('clientPhone').value = '';
        document.getElementById('clientCity').value = '';
        
        // Cerrar formulario
        whatsappForm.classList.remove('active');
        fabricationNotice.classList.remove('active');
        whatsappBtn.innerHTML = '<i class="fab fa-whatsapp"></i> Pedir fabricación por WhatsApp';
    });
}

// Inicializar aplicación
async function inicializarAplicacion() {
    // Mostrar loader
    document.getElementById('loader').classList.add('active');
    
    // Cargar datos desde JSON
    const exito = await cargarDatos();
    
    if (!exito) {
        return;
    }
    
    // Ocultar loader, mostrar contenido
    document.getElementById('loader').classList.remove('active');
    document.getElementById('content').style.display = 'block';
    
    // Configurar tienda
    configurarTienda();
    
    // Mostrar productos y categorías
    mostrarProductos();
    mostrarCategorias();
    
    // Configurar filtro de categorías
    const categorySelect = document.getElementById('categorySelect');
    categorySelect.addEventListener('change', function() {
        filtrarPorCategoria(this.value);
    });
    
    // Configurar buscador
    configurarBuscador();
    
    // Configurar WhatsApp
    configurarWhatsApp();
    
    // Configurar eventos del popup
    document.getElementById('closePopup').addEventListener('click', cerrarPopup);
    document.getElementById('productPopup').addEventListener('click', (e) => {
        if (e.target === document.getElementById('productPopup')) {
            cerrarPopup();
        }
    });
    
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && document.getElementById('productPopup').classList.contains('active')) {
            cerrarPopup();
        }
    });
    
    // Cargar imagen de perfil con fallback
    const profileImg = document.querySelector('.profile-circle img');
    profileImg.onerror = function() {
        this.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgZmlsbD0iIzBlYTVhNSIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LXNpemU9IjI0IiBkeT0iMC4zZW0iIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IiNmZmYiIGZvbnQtZmFtaWx5PSJBcmlhbCxzYW5zLXNlcmlmIj5NPC90ZXh0Pjwvc3ZnPg==';
    };
}

function cerrarPopup() {
    document.getElementById('productPopup').classList.remove('active');
    document.body.style.overflow = 'auto';
}

// Iniciar la aplicación cuando carga la página
document.addEventListener('DOMContentLoaded', inicializarAplicacion);
</script>
</body>
</html>
